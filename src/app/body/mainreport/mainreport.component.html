<div class="mat-progress" *ngIf="loading$ | async">
  <div class="mat-progress-spinner">
    <mat-progress-spinner [mode]="'indeterminate'" *ngIf="loading$ | async"></mat-progress-spinner>
  </div>
</div>
<section class="mt-3">
  <div class="container-fluid">
    <tabset #staticTabs>
      <tab heading="البحث">
        <div class="row mt-2">
          <div class="col-sm-4">
            <div class="out-line">
              <div class="row">
                <h2 class="col-xl-12 text-center">تصدير السداد</h2>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <select class="custom-select" [(ngModel)]="valueSectorPayment" (click)="companySlecetPayment()">
                      <option *ngFor="let item of sector" [value]="item.code">
                        {{ item.name }}</option>
                    </select>
                    <div class="input-group-append">
                      <label class="input-group-text">القطاع</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <select class="custom-select" [(ngModel)]="valueCompanyPayment">
                      <option *ngFor="let item of company" [value]="item.code">
                        {{ item.name }}</option>
                    </select>
                    <div class="input-group-append">
                      <label class="input-group-text">الشركة</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <select class="custom-select" [(ngModel)]="valueGroubPayment">
                      <option *ngFor="let item of group" [value]="item.name">
                        {{ item.name }}</option>
                    </select>
                    <div class="input-group-append">
                      <label class="input-group-text">الفروع</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <input type="text" placeholder="Datepicker" class="form-control" bsDatepicker
                      [(ngModel)]="dtp1Payment" value="{{ dtp1Payment | date:'dd-MM-yyyy' }}">
                    <div class="input-group-append">
                      <label class="input-group-text" for="inputGroupSelect13">من تاريخ</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <input type="text" placeholder="Datepicker" class="form-control" bsDatepicker
                      [(ngModel)]="dtp2Payment" value="{{ dtp2Payment | date:'dd-MM-yyyy' }}">
                    <div class="input-group-append">
                      <label class="input-group-text" for="inputGroupSelect13">الى تاريخ</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <input type="button" class="btn btn-success btn-block" value="السداد" (click)="paymentResult()">
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <input type="button" class="btn btn-success btn-block" value="الخصم" (click)="paymentResult()">
                </div>
              </div>
            </div>
          </div>
          <!-- ========================================= -->
          <div class="col-sm-4">
            <div class="out-line">
              <div class="row">
                <h2 class="col-xl-12 text-center">تصدير الافادات</h2>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <select class="custom-select" [(ngModel)]="valueSectorStatment" (click)="companySlecetStatment()">
                      <option *ngFor="let item of sector" [value]="item.code">
                        {{ item.name }}</option>
                    </select>
                    <div class="input-group-append">
                      <label class="input-group-text">القطاع</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <select class="custom-select" [(ngModel)]="valueCompanyStatment">
                      <option *ngFor="let item of company" [value]="item.code">
                        {{ item.name }}</option>
                    </select>
                    <div class="input-group-append">
                      <label class="input-group-text">الشركة</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <select class="custom-select" [(ngModel)]="valueGroubStatment">
                      <option *ngFor="let item of group" [value]="item.name">
                        {{ item.name }}</option>
                    </select>
                    <div class="input-group-append">
                      <label class="input-group-text">الفروع</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <input type="text" placeholder="Datepicker" class="form-control" bsDatepicker
                      [(ngModel)]="dtp1Statment" value="{{ dtp1Statment | date:'dd-MM-yyyy' }}">
                    <div class="input-group-append">
                      <label class="input-group-text" for="inputGroupSelect13">من تاريخ</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <input type="text" placeholder="Datepicker" class="form-control" bsDatepicker
                      [(ngModel)]="dtp2Statment" value="{{ dtp2Statment | date:'dd-MM-yyyy' }}">
                    <div class="input-group-append">
                      <label class="input-group-text" for="inputGroupSelect13">الى تاريخ</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <input type="button" class="btn btn-success btn-block" value="تاريخ الاجراء"
                    (click)="statmentReport()">
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <input type="button" class="btn btn-success btn-block" value="تاريخ المراجعة"
                    (click)="statmentReportReview()">
                </div>
              </div>
            </div>
          </div>
          <!-- ========================================= -->
          <div class="col-sm-4">
            <div class="out-line">
              <div class="row">
                <h2 class="col-xl-12 text-center">تصدير الملفات</h2>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <select class="custom-select" [(ngModel)]="valueSectorFiles" (click)="companySlecetFiles()">
                      <option *ngFor="let item of sector" [value]="item.code">
                        {{ item.name }}</option>
                    </select>
                    <div class="input-group-append">
                      <label class="input-group-text">القطاع</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <select class="custom-select" [(ngModel)]="valueCompanyFiles">
                      <option *ngFor="let item of company" [value]="item.code">
                        {{ item.name }}</option>
                    </select>
                    <div class="input-group-append">
                      <label class="input-group-text">الشركة</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <div class="input-group input-group-m">
                    <select class="custom-select" [(ngModel)]="valueGroubFiles">
                      <option *ngFor="let item of group" [value]="item.name">
                        {{ item.name }}</option>
                    </select>
                    <div class="input-group-append">
                      <label class="input-group-text">الفروع</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-xl-12">
                  <input type="button" class="btn btn-success btn-block" value="Search" (click)="filesReport()">
                </div>
              </div>
            </div>
          </div>
        </div>
      </tab>
      <tab heading="النتائج">
        <div class="row mt-2" *ngIf="tableAppear == 1">
          <div class="col-xl-12">
            <div class="outof-rtl">
              <dx-data-grid [dataSource]="resultPayment" [rowAlternationEnabled]="true" [allowColumnReordering]="true"
                [columnAutoWidth]="true" [showBorders]="true">
                <dxo-paging [pageSize]="10"></dxo-paging>
                <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[5,10,20,30,50,80,100]" [showInfo]="true">
                </dxo-pager>
                <dxo-filter-row [visible]="true" [applyFilter]="true"></dxo-filter-row>
                <dxo-export [enabled]="true"></dxo-export>
                <dxo-header-filter [visible]="true"></dxo-header-filter>
                <dxi-column dataField="code" caption="الكود"></dxi-column>
                <dxi-column dataField="name" caption="الاسم"></dxi-column>
                <dxi-column dataField="civilID" caption="الرقم المدنى"></dxi-column>
                <dxi-column dataField="cases" caption="الحالة"></dxi-column>
                <dxi-column dataField="payment" caption="المدفوع"></dxi-column>
                <dxi-column dataField="totalDue" caption="المطالبة"></dxi-column>
                <dxi-column dataField="totalPayement" caption="اجمالى المدفوع"></dxi-column>
                <dxi-column dataField="resom" caption="الرسوم"></dxi-column>
                <dxi-column dataField="remain" caption="المتيقى"></dxi-column>
                <dxi-column dataField="remianWithResom" caption="المتبقى + الرسوم"></dxi-column>
                <dxi-column dataField="autoNum" caption="الرقم الالى"></dxi-column>
                <dxi-column dataField="datePay" caption="تاريخ الدفع"></dxi-column>
                <dxi-column dataField="client" caption="الموكل"></dxi-column>
                <dxi-column dataField="nationality" caption="الجنسية"></dxi-column>
                <dxi-column dataField="emp" caption="الموظف"></dxi-column>
                <dxi-column dataField="entryEmp" caption="مدخل السداد"></dxi-column>
                <dxi-column dataField="resonDue" caption="سبب المديونية"></dxi-column>
                <dxi-column dataField="batchNo" caption="رقم الباتش"></dxi-column>
                <dxi-column dataField="dateLogin" caption="تاريخ الورود"></dxi-column>
                <dxi-column dataField="empNUm" caption="رقم الموظف"></dxi-column>
                <dxi-column dataField="contract" caption="العقد"></dxi-column>
                <dxi-column dataField="codeClient" caption="كود الموكل"></dxi-column>
                <dxi-column dataField="idPay" caption="ID"></dxi-column>
                <dxi-column dataField="number_d" caption="رقم الايصال"></dxi-column>
                <dxi-column dataField="honstDate" caption="تاريخ الايصال"></dxi-column>
                <dxi-column dataField="transeNote" caption="التحويل"></dxi-column>
                <dxi-column dataField="transeDate" caption="تاريخ التحويل"></dxi-column>
                <dxi-column dataField="transeBackDate" caption="تاريخ العودة"></dxi-column>
                <dxi-column dataField="note2" caption="ملاحظات السداد"></dxi-column>
                <dxi-column dataField="groub" caption="المجموعة"></dxi-column>
                <dxi-column dataField="payway" caption="طريقة الدفع"></dxi-column>
                <dxi-column dataField="cheqNum" caption="رقم الشيك"></dxi-column>
                <dxi-column dataField="sector" caption="القطاع"></dxi-column>
              </dx-data-grid>
            </div>
          </div>
        </div>
        <div class="row mt-2" *ngIf="tableAppear == 2">
          <div class="col-xl-12">
            <div class="outof-rtl">
              <dx-data-grid [dataSource]="resultStatment" [rowAlternationEnabled]="true" [allowColumnReordering]="true"
                [columnAutoWidth]="true" [showBorders]="true">
                <dxo-paging [pageSize]="10"></dxo-paging>
                <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[5,10,20,30,50,80,100]" [showInfo]="true">
                </dxo-pager>
                <dxo-filter-row [visible]="true" [applyFilter]="true"></dxo-filter-row>
                <dxo-export [enabled]="true"></dxo-export>
                <dxo-header-filter [visible]="true"></dxo-header-filter>
                <dxi-column dataField="id" caption="ID"></dxi-column>
                <dxi-column dataField="code" caption="الكود"></dxi-column>
                <dxi-column dataField="name" caption="الاسم"></dxi-column>
                <dxi-column dataField="civilID" caption="الرقم المدنى"></dxi-column>
                <dxi-column dataField="casese" caption="الحالة"></dxi-column>
                <dxi-column dataField="nationality" caption="الجنسية"></dxi-column>
                <dxi-column dataField="dateEvent" caption="تاريخ الافادة"></dxi-column>
                <dxi-column dataField="dateReview" caption="تاريخ المراجعة"></dxi-column>
                <dxi-column dataField="way" caption="طريقة التواصل"></dxi-column>
                <dxi-column dataField="connect" caption="نتيجة التواصل"></dxi-column>
                <dxi-column dataField="number" caption="الرقم"></dxi-column>
                <dxi-column dataField="numberUser" caption="مستخدم الرقم"></dxi-column>
                <dxi-column dataField="note" caption="الافادة"></dxi-column>
                <dxi-column dataField="emp" caption="الموظف"></dxi-column>
                <dxi-column dataField="batchNo" caption="رقم الباتش"></dxi-column>
                <dxi-column dataField="client" caption="الموكل"></dxi-column>
                <dxi-column dataField="contract" caption="العقد"></dxi-column>
                <dxi-column dataField="resonDue" caption="سبب المديونية"></dxi-column>
                <dxi-column dataField="dateLogin" caption="تاريخ الورود"></dxi-column>
                <dxi-column dataField="totalPayement" caption="المدفوع"></dxi-column>
                <dxi-column dataField="remain" caption="المتبقى"></dxi-column>
                <dxi-column dataField="remianWithResom" caption="المتبقى + الرسوم"></dxi-column>
                <dxi-column dataField="caseFile" caption="حالة الملف"></dxi-column>
                <dxi-column dataField="department" caption="القسم"></dxi-column>
                <dxi-column dataField="sector" caption="القطاع"></dxi-column>
              </dx-data-grid>
            </div>
          </div>
        </div>
        <div class="row mt-2" *ngIf="tableAppear == 3">
          <div class="col-xl-12">
            <div class="outof-rtl">
              <dx-data-grid [dataSource]="resultFiles" [rowAlternationEnabled]="true" [allowColumnReordering]="true"
                [columnAutoWidth]="true" [showBorders]="true">
                <dxo-paging [pageSize]="10"></dxo-paging>
                <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[5,10,20,30,50,80,100]" [showInfo]="true">
                </dxo-pager>
                <dxo-filter-row [visible]="true" [applyFilter]="true"></dxo-filter-row>
                <dxo-export [enabled]="true"></dxo-export>
                <dxo-header-filter [visible]="true"></dxo-header-filter>
                <dxi-column dataField="code" caption="الكود"></dxi-column>
                <dxi-column dataField="name" caption="الاسم"></dxi-column>
                <dxi-column dataField="cases" caption="الحالة"></dxi-column>
                <dxi-column dataField="resonDue" caption="سبب المديونية"></dxi-column>
                <dxi-column dataField="contract" caption="العقد"></dxi-column>
                <dxi-column dataField="batchNum" caption="الباتش"></dxi-column>
                <dxi-column dataField="emp" caption="الموظف"></dxi-column>
                <dxi-column dataField="empNum" caption="رقم الموظف"></dxi-column>
                <dxi-column dataField="totalDue" caption="المطالبة"></dxi-column>
                <dxi-column dataField="totalPay" caption="اجمالى المدفوع"></dxi-column>
                <dxi-column dataField="remain" caption="المتبقى"></dxi-column>
                <dxi-column dataField="dateLogin" caption="تاريخ الورود"></dxi-column>
                <dxi-column dataField="client" caption="الموكل"></dxi-column>
                <dxi-column dataField="dateRecive" caption="تاريخ الاستلام"></dxi-column>
                <dxi-column dataField="dateWithdrawal" caption="تاريخ السحب"></dxi-column>
                <dxi-column dataField="autoNum" caption="الرقم الالى"></dxi-column>
                <dxi-column dataField="note" caption="الملاحظات"></dxi-column>
                <dxi-column dataField="address" caption="العنوان"></dxi-column>
                <dxi-column dataField="nationality" caption="الجنسية"></dxi-column>
                <dxi-column dataField="civilID" caption="المدنى"></dxi-column>
                <dxi-column dataField="custIDOffice1" caption="1ترقيم المكتب"></dxi-column>
                <dxi-column dataField="custIDOffic2" caption="ترقيم المكتب2"></dxi-column>
                <dxi-column dataField="lineKindNote" caption="ترقيم الخط"></dxi-column>
                <dxi-column dataField="note2" caption="ملاحظات2"></dxi-column>
                <dxi-column dataField="note3" caption="ملاحظات3"></dxi-column>
                <dxi-column dataField="note4" caption="ملاحظات4"></dxi-column>
                <dxi-column dataField="fileNote" caption="ملاحظة الملفات"></dxi-column>
                <dxi-column dataField="note6" caption="ملاحظات6"></dxi-column>
                <dxi-column dataField="court" caption="المحكمة"></dxi-column>
                <dxi-column dataField="motabaa" caption="حالة المتابعة"></dxi-column>
                <dxi-column dataField="civilIDCase" caption="حالة المدنية"></dxi-column>
                <dxi-column dataField="dkhliaCase" caption="حالة الداخلية"></dxi-column>
                <dxi-column dataField="custCase" caption="حالة الملف"></dxi-column>
                <dxi-column dataField="towaselCase" caption="حالة التواصل"></dxi-column>
                <dxi-column dataField="motwaselCase" caption="حالة المتواصل"></dxi-column>
                <dxi-column dataField="lastpay" caption="اخر دفعة سداد"></dxi-column>
                <dxi-column dataField="dateLastPay" caption="تاريخ اخر سداد"></dxi-column>
                <dxi-column dataField="dateLastEvent" caption="تاريخ اخر افادة"></dxi-column>
                <dxi-column dataField="dateReview" caption="تاريخ المراجعة"></dxi-column>
                <dxi-column dataField="discount" caption="الخصم"></dxi-column>
                <dxi-column dataField="discountRatio" caption="نسبة الخصم"></dxi-column>
                <dxi-column dataField="sector" caption="القطاع"></dxi-column>
                <dxi-column dataField="TotalResom" caption="اجمالى الرسوم"></dxi-column>
                <dxi-column dataField="lastPhoneNumber" caption="هاتف العميل"></dxi-column>
                <dxi-column dataField="dateLastPhoneNumber" caption="تاريخ الاضافة"></dxi-column>
                <dxi-column dataField="groub" caption="الفرع"></dxi-column>
              </dx-data-grid>
            </div>
          </div>
        </div>
      </tab>
    </tabset>
  </div>
</section>